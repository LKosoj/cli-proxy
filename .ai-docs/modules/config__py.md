# config

```markdown
Модуль предоставляет средства для загрузки и управления конфигурацией приложения через YAML-файл. Основной объект конфигурации — `AppConfig`, содержащий настройки Telegram-бота, инструментов, MCP-серверов, пресетов и других параметров. Конфигурация разбита на логические компоненты, представленные dataclass-ами, что обеспечивает типобезопасность и удобство использования. Функция `load_config` парсит YAML-файл и возвращает объект `AppConfig`. Также реализована функция `save_config` для сохранения конфигурации обратно в файл.

Ключевые структуры данных  
AppConfig — корневой объект конфигурации, объединяющий все настройки приложения  
TelegramConfig — конфигурация Telegram-бота: токен и список разрешённых chat ID  
ToolConfig — описание внешнего инструмента: команды, режимы, переменные окружения и т.д.  
DefaultsConfig — глобальные настройки по умолчанию: пути, таймауты, API-ключи, ограничения  
MCPConfig — настройки встроенного MCP-сервера (включение, хост, порт, токен)  
MCPClientServerConfig — конфигурация подключения к внешнему MCP-серверу (клиентская часть)  
PresetConfig — пресет подсказки: имя и текстовый шаблон

load_config(path: str) -> AppConfig
Загружает и парсит конфигурацию из YAML-файла по указанному пути.
Аргументы
path — путь к YAML-файлу конфигурации.
Возвращает
Объект AppConfig с заполненными данными из файла.
Исключения
FileNotFoundError — если файл не найден.
yaml.YAMLError — если произошла ошибка при разборе YAML.
ValueError — при отсутствии обязательных полей или неверных типах данных.
---
save_config(config: AppConfig) -> None
Сохраняет объект AppConfig в YAML-файл по указанному пути.
Аргументы
config — объект конфигурации для сохранения.
Исключения
OSError — при ошибках записи в файл.
yaml.YAMLError — при ошибках сериализации в YAML.
---
class TelegramConfig
Конфигурация Telegram-бота: аутентификация и фильтрация чатов.
Поля
token — токен бота для доступа к Telegram API.
whitelist_chat_ids — список разрешённых chat ID для взаимодействия.
---
class ToolConfig
Описание внешнего инструмента, запускаемого ботом.
Поля
name — имя инструмента.
mode — режим работы: headless или interactive.
cmd — основная команда запуска.
headless_cmd — команда для headless-режима (опционально).
resume_cmd — команда для возобновления выполнения (опционально).
image_cmd — команда для обработки изображений (опционально).
interactive_cmd — команда для интерактивного режима (опционально).
prompt_regex — регулярное выражение для определения приглашения ввода (опционально).
resume_regex — регулярное выражение для определения возможности возобновления (опционально).
help_cmd — команда для получения справки (опционально).
env — переменные окружения для запуска инструмента (опционально).
auto_commands — команды, выполняемые автоматически при старте (опционально).
---
class DefaultsConfig
Глобальные настройки по умолчанию для различных компонентов приложения.
Поля
workdir — рабочая директория.
idle_timeout_sec — таймаут бездействия в секундах.
summary_max_chars — максимальное количество символов в сводке.
html_filename_prefix — префикс имени HTML-файла с выводом.
state_path — путь к файлу состояния.
toolhelp_path — путь к файлу справки по инструментам.
openai_api_key — API-ключ OpenAI (опционально).
openai_model — модель OpenAI по умолчанию (опционально).
openai_base_url — базовый URL для OpenAI-совместимого API (опционально).
zai_api_key — API-ключ Z.AI (опционально).
tavily_api_key — API-ключ Tavily (опционально).
jina_api_key — API-ключ Jina (опционально).
github_token — токен GitHub (опционально).
log_path — путь к файлу логов.
image_temp_dir — временная директория для изображений.
image_max_mb — максимальный размер изображения в мегабайтах.
memory_max_kb — максимальный объём памяти в килобайтах.
memory_compact_target_kb — целевой объём памяти после компрессии.
clarification_enabled — включена ли функция уточнения запросов.
clarification_keywords — список ключевых слов, инициирующих уточнение.
---
class MCPConfig
Конфигурация встроенного MCP-сервера.
Поля
enabled — включён ли сервер.
host — хост для прослушивания.
port — порт для подключения.
token — токен аутентификации (опционально).
---
class MCPClientServerConfig
Конфигурация клиента для подключения к внешнему MCP-серверу.
Поля
name — имя подключения.
enabled — включено ли подключение.
transport — тип транспорта: stdio или http.
cmd — команда запуска сервера (для stdio).
url — URL сервера (для http).
cwd — рабочая директория для запуска команды (опционально).
env — переменные окружения (опционально).
headers — HTTP-заголовки для подключения (опционально).
timeout_ms — таймаут запроса в миллисекундах.
---
class PresetConfig
Пресет текстового шаблона для быстрого ввода.
Поля
name — имя пресета.
prompt — текст подсказки.
---
class AppConfig
Корневой объект конфигурации приложения.
Поля
telegram — настройки Telegram-бота.
tools — словарь инструментов по имени.
defaults — настройки по умолчанию.
mcp — конфигурация встроенного MCP-сервера.
mcp_clients — список конфигураций внешних MCP-серверов.
presets — список пресетов подсказок.
path — путь к файлу конфигурации (заполняется при загрузке).
```
