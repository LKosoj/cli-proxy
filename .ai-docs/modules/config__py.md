# config

Модуль предоставляет функциональность для загрузки и управления конфигурацией приложения через YAML-файл с поддержкой переменных окружения. Основные параметры конфигурации структурированы в dataclass-объекты, охватывающие настройки Telegram-бота, инструментов, MCP-сервера, пресетов и общих параметров. Конфигурация может быть загружена с автоматической подгрузкой `.env`-файла из той же директории. Поддерживается гибкая настройка поведения инструментов, режимов выполнения и интеграций с внешними сервисами.

Ключевые структуры данных  
TelegramConfig — Конфигурация Telegram-бота: токен и список разрешённых chat ID.  
ToolConfig — Описание командного инструмента, включая команды для разных режимов и настройки взаимодействия.  
DefaultsConfig — Глобальные настройки приложения по умолчанию, включая пути, таймауты, API-ключи и параметры управления памятью.  
MCPConfig — Настройки встроенного MCP-сервера (включение, хост, порт, токен).  
MCPClientServerConfig — Конфигурация клиента для подключения к внешнему MCP-серверу.  
PresetConfig — Пресет подсказки с именем и текстом.  
AppConfig — Полная конфигурация приложения, объединяющая все компоненты.

load_config(path: str) -> AppConfig  
Загружает и парсит конфигурацию из YAML-файла по указанному пути.  
Аргументы  
path — Путь к YAML-файлу конфигурации.  
Возвращает  
Объект AppConfig с заполненными настройками.  
Исключения  
FileNotFoundError — Если файл конфигурации не найден.  
yaml.YAMLError — При ошибках парсинга YAML.  
Exception — При других ошибках загрузки .env или чтения файла.

---
save_config(config: AppConfig) -> None  
Сохраняет объект конфигурации в YAML-файл, указанный в config.path.  
Аргументы  
config — Объект AppConfig, который необходимо сохранить.  
Исключения  
IOError — Если не удалось записать файл.  
YAMLError — Если произошла ошибка при сериализации в YAML.

---
class TelegramConfig  
Конфигурация Telegram-бота: токен и список разрешённых chat ID.  
Поля  
token — Токен бота от BotFather.  
whitelist_chat_ids — Список chat_id, которым разрешено взаимодействовать с ботом.  
Методы  
---  
class ToolConfig  
Описание командного инструмента, включая команды для разных режимов и настройки взаимодействия.  
Поля  
name — Имя инструмента.  
mode — Режим выполнения: headless или interactive.  
cmd — Основная команда для запуска инструмента.  
headless_cmd — Альтернативная команда для headless-режима.  
resume_cmd — Команда для возобновления выполнения.  
image_cmd — Команда для обработки изображений.  
interactive_cmd — Команда для интерактивного режима.  
prompt_regex — Регулярное выражение для определения приглашения ввода.  
resume_regex — Регулярное выражение для определения возможности возобновления.  
help_cmd — Команда для получения справки.  
env — Переменные окружения, специфичные для инструмента.  
auto_commands — Список команд, автоматически выполняемых при запуске.  
Методы  
---  
class DefaultsConfig  
Глобальные настройки приложения по умолчанию, включая пути, таймауты, API-ключи и параметры управления памятью.  
Поля  
workdir — Рабочая директория по умолчанию.  
idle_timeout_sec — Таймаут бездействия в секундах.  
summary_max_chars — Максимальное количество символов в сводке.  
html_filename_prefix — Префикс имени HTML-файла с выводом.  
state_path — Путь к файлу состояния.  
toolhelp_path — Путь к файлу справки по инструментам.  
openai_api_key — Ключ API для OpenAI.  
openai_model — Модель OpenAI по умолчанию.  
openai_big_model — Модель OpenAI для тяжёлых задач.  
openai_base_url — Базовый URL для OpenAI-совместимого API.  
big_model_to_use — Устаревший алиас для openai_big_model.  
zai_api_key — Ключ API для Z.AI.  
tavily_api_key — Ключ API для Tavily.  
jina_api_key — Ключ API для Jina.  
github_token — Токен GitHub для аутентификации.  
log_path — Путь к файлу логов.  
image_temp_dir — Директория для временных изображений.  
image_max_mb — Максимальный размер изображения в мегабайтах.  
memory_max_kb — Максимальный объём памяти в килобайтах.  
memory_compact_target_kb — Целевой объём памяти после компрессии.  
clarification_enabled — Включена ли функция уточнения запросов.  
clarification_keywords — Список ключевых слов, вызывающих уточнение.  
manager_max_tasks — Максимальное количество задач в менеджере.  
manager_max_attempts — Максимальное количество попыток выполнения задачи.  
manager_decompose_timeout_sec — Таймаут декомпозиции задачи.  
manager_dev_timeout_sec — Таймаут разработки задачи.  
manager_review_timeout_sec — Таймаут проверки задачи.  
manager_dev_report_max_chars — Максимальное количество символов в отчёте разработки.  
manager_auto_resume — Автоматическое возобновление выполнения.  
manager_auto_commit — Автоматический git commit после одобренного шага.  
manager_debug_log — Сохранять ли отладочные логи менеджера.  
Методы  
---  
class MCPConfig  
Настройки встроенного MCP-сервера (включение, хост, порт, токен).  
Поля  
enabled — Включён ли MCP-сервер.  
host — Хост для прослушивания.  
port — Порт для подключения.  
token — Токен аутентификации (опционально).  
Методы  
---  
class MCPClientServerConfig  
Конфигурация клиента для подключения к внешнему MCP-серверу.  
Поля  
name — Имя сервера.  
enabled — Включено ли подключение.  
transport — Тип транспорта: stdio или http.  
cmd — Команда для запуска сервера (для stdio).  
url — URL сервера (для http).  
cwd — Рабочая директория для запуска сервера.  
env — Переменные окружения для сервера.  
headers — HTTP-заголовки для подключения.  
timeout_ms — Таймаут запроса в миллисекундах.  
Методы  
---  
class PresetConfig  
Пресет подсказки с именем и текстом.  
Поля  
name — Имя пресета.  
prompt — Текст подсказки.  
Методы  
---  
class AppConfig  
Полная конфигурация приложения, объединяющая все компоненты.  
Поля  
telegram — Настройки Telegram-бота.  
tools — Словарь инструментов по имени.  
defaults — Настройки по умолчанию.  
mcp — Конфигурация встроенного MCP-сервера.  
mcp_clients — Список конфигураций внешних MCP-серверов.  
presets — Список пресетов подсказок.  
path — Путь к файлу конфигурации (заполняется после загрузки).  
Методы
