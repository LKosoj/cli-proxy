# agent/tooling/mcp_plugin

```markdown
Модуль реализует плагин инструмента для интеграции с удалёнными MCP (Model Control Protocol) сервисами. Он позволяет регистрировать и выполнять вызовы к MCP-инструментам через менеджер MCP, преобразуя их спецификации и результаты в стандартный формат. Плагин обеспечивает нормализацию схем ввода и форматирование вывода результатов выполнения инструментов.

Ключевые структуры данных  
MCPRemoteToolPlugin — Реализация плагина инструмента для вызова удалённых MCP-инструментов через MCPManager

_normalize_schema(schema)
Нормализует JSON-схему входных данных MCP-инструмента, приводя её к строгому объектному формату.
Аргументы
schema — Исходная схема, возможно, с нестандартной структурой
Возвращает
Нормализованная схема с гарантированными полями 'type', 'properties' и 'required'

---
_render_mcp_result(result)
Преобразует результат вызова MCP-инструмента в читаемую текстовую строку.
Аргументы
result — Результат выполнения MCP-инструмента, обычно содержащий поле 'content'
Возвращает
Строковое представление результата, объединённое из текстовых частей или полный JSON-дамп в случае сложной структуры

---
class MCPRemoteToolPlugin
Плагин для интеграции удалённого MCP-инструмента в систему управления инструментами.
Поля
_registry_name — Идентификатор инструмента в реестре
_server_name — Имя MCP-сервера, предоставляющего инструмент
_tool — Информация об инструменте (MCPToolInfo)
_manager — Экземпляр MCPManager для выполнения вызовов
Методы
__init__(*, registry_name: str, server_name: str, tool: MCPToolInfo, manager: MCPManager) -> None — Инициализирует плагин с указанием сервера, инструмента и менеджера
get_function_prefix() -> str — Возвращает пустую строку, отключая префикс имен функций
get_source_name() -> str — Возвращает имя источника в формате "MCP:<имя_сервера>"
get_spec() -> ToolSpec — Возвращает спецификацию инструмента, включая нормализованную схему параметров
execute(args: Dict[str, Any], ctx: Dict[str, Any]) -> Dict[str, Any] — Асинхронно вызывает MCP-инструмент и возвращает обработанный результат
```
