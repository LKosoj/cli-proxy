# Git‑справка для бота (для начинающих)

Эта справка объясняет, как пользоваться Git‑кнопками бота, если вы не знакомы с Git. Здесь нет «магии»: бот лишь запускает стандартные git‑команды и показывает результат.

## 1) Что такое Git в двух словах
Git — это система версий. У проекта есть:
- **Ветки** (branches) — параллельные линии изменений.
- **Удалённый репозиторий** (remote, обычно `origin`) — «серверная» копия.
- **Локальная копия** — ваш рабочий каталог.

## 2) С чего начать
1) Убедитесь, что активна нужная сессия и каталог с репозиторием.
2) Вызовите меню `/git`.
3) Начните с **Status** — это безопасная команда, она ничего не меняет.

## 3) Что показывает Status
**Status** пишет:
- **Ветка** — на какой ветке вы сейчас работаете.
- **Состояние**:  
  - **clean** — нет локальных изменений;  
  - **dirty** — есть изменения в файлах.
- **Upstream** — удалённая ветка, с которой сравнивается ваша.
- **ahead/behind** — насколько вы впереди/позади удалённой ветки.
- **Конфликт** — есть ли конфликтные файлы.

Если вы не понимаете статус — просто пришлите его разработчику/лиду.

## 4) Основные действия в меню
### Status
Показывает состояние. Безопасно.

### Fetch
Скачивает информацию о новых коммитах с сервера, **не меняя** ваши файлы.  
Это «обновить информацию», но не «обновить код».

### Pull
Пытается обновить ваш код из удалённой ветки:
- Если обновление можно применить «прямо» — выполнится **fast‑forward** (без конфликтов).
- Если нельзя — бот предложит **Merge** или **Rebase**.

### Merge
Сливает выбранную ветку в вашу. Может создать merge‑коммит и может дать конфликты.

### Rebase
Переписывает вашу историю поверх удалённых изменений. Обычно чище, но потенциально сложнее при конфликтах.

### Diff
Показывает, какие файлы изменены (кратко).

### Summary
Собирает короткий отчёт: `status`, `diff --stat` и последние 10 коммитов.

### Log
Показывает последние 20 коммитов.

### Stash
Сохраняет ваши незакоммиченные изменения «в карман» и очищает рабочую копию.

### Commit
Создает коммит из текущих изменений:
- сначала выполняется `git add -A`,
- затем `git commit -m "<сообщение>"`.

Бот попросит прислать сообщение коммита отдельным сообщением.  
Если изменений нет — коммит не выполняется.  
Для отмены отправьте `-`.

### Push
Отправляет ваши локальные коммиты на удалённый сервер.  
Важно: **push не делает commit** — сначала нужно выполнить **Commit**.  
Если upstream настроен — выполняется обычный `git push`.  
Если upstream не настроен, бот пытается сделать `git push -u <remote> <branch>` (сначала `origin`, иначе первый доступный remote).  
Если remote не найден — push не выполняется.

## 5) Как бот решает, что тянуть
Бот выбирает **upstream** так:
1) Если у текущей ветки есть удалённая пара — используется она.
2) Иначе пробует `origin/<branch>`.
3) Если и это не найдено — берёт `origin/HEAD`.

## 6) Pull шаг за шагом
Когда вы нажимаете **Pull**:
1) Выполняется `git fetch --prune`.
2) Сравнивается, насколько вы **ahead/behind**.
3) Если можно — `git pull --ff-only`.
4) Если нельзя — бот предлагает **Merge** или **Rebase**.

## 7) Что делать при конфликтах (самое важное)
Конфликт — это ситуация, когда Git не может сам понять, какие изменения оставить.

Когда конфликт найден, бот показывает:
- список файлов (до 10),
- кнопки **Открыть diff**, **Abort**, **Continue**, **Позвать агента**.

### Открыть diff
Показывает отличия, где конфликт. Это подсказка, что исправлять.

### Abort
Отменяет текущий merge/rebase и возвращает всё назад.

### Continue
Продолжает merge/rebase **после** того, как вы исправили конфликт вручную.

### Позвать агента
Отправляет в CLI‑агент текст с просьбой **объяснить**, как решать конфликт.  
Это **не** автоматическое исправление. Агент **не запускает** git‑команды сам.

## 8) Как исправлять конфликты вручную (очень кратко)
1) Нажмите **Открыть diff**.
2) В редакторе найдите конфликтные блоки (`<<<<<<`, `======`, `>>>>>>`).
3) Оставьте правильный вариант текста, удалите конфликтные метки.
4) Сохраните файл.
5) Когда всё исправили — нажмите **Continue**.

Если не уверены — используйте **Abort** и попросите помощь.

## 9) Частые ошибки новичков
- Делать **Merge/Rebase**, не посмотрев **Status**.
- Пытаться **Continue**, не исправив файлы.
- Думать, что **Позвать агента** всё исправит автоматически.

## 10) Ограничения и безопасность
- Бот не делает «умный» авто‑мерж — только запускает git‑команды.
- Если каталог не является репозиторием — Git‑кнопки не работают.
- Если сессия занята, запрос может попасть в очередь.

## 11) Доступ к приватным репозиториям
Если git по HTTPS требует логин/пароль, укажите Personal Access Token:
- `defaults.github_token` в `config.yaml`
Токен используется для `clone/fetch/pull/push` без интерактивных запросов.

## 12) Мини‑шпаргалка
- «Проверить всё» → **Status**  
- «Краткий отчёт» → **Summary**  
- «Обновить инфо, но не код» → **Fetch**  
- «Обновить код» → **Pull**  
- «Зафиксировать изменения» → **Commit**  
- «Отправить изменения на сервер» → **Push**  
- «Есть конфликт» → **Diff → исправить → Continue**  
- «Хочу отменить всё» → **Abort**  
